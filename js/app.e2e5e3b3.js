(function(){"use strict";var e={9739:function(e,o,t){var r=t(6369),l=function(){var e=this,o=e._self._c;return o("div",{staticClass:"building-wrapper"},[o("div",{staticClass:"building"},e._l(e.floors,(function(t){return o("FloorItem",{key:t,attrs:{floor:t,numberOfElevators:e.numberOfElevators},on:{"call-elevator":function(o){return e.callElevator(t)}}})})),1)])},a=[],s=(t(7658),function(){var e=this,o=e._self._c;return o("li",{staticClass:"floor"},[e._l(e.elevators,(function(t){return o("ElevatorItem",{key:t.id,staticClass:"elevator-container",attrs:{elevator:t,floor:e.floor}})})),o("ControlPanelItem",{attrs:{floor:e.floor}})],2)}),n=[],i=function(){var e=this,o=e._self._c;return o("div",[o("div",{class:[e.elevator.currentFloor===e.floor?"elevator":"",e.elevator.isJustArrived&&e.elevator.currentFloor===e.floor?"elevator-blinking":""]},[o("p",{staticClass:"display"},[e._v(" "+e._s(e.elevator.currentFloor===e.floor&&e.elevator.isMoving?e.elevator.currentFloor<e.elevator.targetFloor?"↑":"↓":"")+" "+e._s(e.elevator.currentFloor===e.floor?e.elevator.targetFloor:"")+" "+e._s(e.elevator.currentFloor!==e.floor||e.elevator.isMoving?"":e.elevator.currentFloor)+" ")])])])},u=[],c={name:"ElevatorItem",props:["floor","elevator"],computed:{currentFloor(){return this.elevator.currentFloor},isMoving(){return this.elevator.isMoving},isJustArrived(){return this.elevator.isJustArrived},targetFloor(){return this.elevator.targetFloor}}},v=c,f=t(1001),d=(0,f.Z)(v,i,u,!1,null,"346adff0",null),m=d.exports,g=function(){var e=this,o=e._self._c;return o("div",{staticClass:"button-container"},[o("span",[e._v(e._s(e.floor))]),o("button",{staticClass:"button-call",class:{"elevator-in-progress":e.targetFloors.includes(e.floor)||e.callQueue.includes(e.floor)},on:{click:function(o){return e.callElevator(e.floor)}}},[e._v("о")])])},p=[],F=t(3822),h={name:"ControlPanelItem",props:["floor","elevator"],computed:{...(0,F.rn)({callQueue:e=>e.callQueue}),...(0,F.Se)({targetFloors:"getTargetFloors"})},methods:{...(0,F.nv)(["callElevator"])}},b=h,E=(0,f.Z)(b,g,p,!1,null,"41b91813",null),O=E.exports;const S={numberOfFloors:10,numberOfElevators:4};var _={name:"FloorItem",components:{ElevatorItem:m,ControlPanelItem:O},props:["floor"],data(){return{numberOfFloors:S.numberOfFloors,numberOfElevators:S.numberOfElevators}},computed:{...(0,F.rn)(["elevators","callQueue"])},methods:{...(0,F.nv)(["callElevator"])}},Q=_,T=(0,f.Z)(Q,s,n,!1,null,"636126ff",null),C=T.exports,I={name:"App",components:{FloorItem:C},data(){return{numberOfFloors:S.numberOfFloors,numberOfElevators:S.numberOfElevators}},created(){const e=JSON.parse(localStorage.getItem("appState")||"{}");0===Object.keys(e).length?this.$store.dispatch("createElevators"):this.$store.dispatch("loadSavedState")},computed:{...(0,F.OI)(["assignElevatorToFloor"]),...(0,F.rn)(["callQueue"]),floors(){const e=[];for(let o=1;o<=this.numberOfFloors;o++)e.push(o);return e}},methods:{...(0,F.nv)(["callElevator","loadSavedState"])}},$=I,y=(0,f.Z)($,l,a,!1,null,"53f15dff",null),M=y.exports;r.ZP.use(F.ZP);var J=new F.ZP.Store({state:{elevators:[],callQueue:[]},mutations:{addElevator(e,o){e.elevators.push(o)},setPassedFloors(e,o){e.passedFloors=o},setCurrentFloor(e,o){e.currentFloor=o},setIsMoving(e,o){e.isMoving=o},setIsJustArrived(e,o){e.isJustArrived=o},setCallQueue(e,o){e.callQueue=o},setTargetFloor(e,o){e.targetFloor=o},assignElevatorToFloor(e,{elevator:o,floor:t}){o.targetFloor=t,o.isMoving=!0,this.commit("saveState");const r=t>o.currentFloor?1:-1,l=setInterval((()=>{o.targetFloor>0&&(o.currentFloor+=r,this.commit("saveState"),o.targetFloor!==o.currentFloor&&(o.passedFloors.push(o.currentFloor),this.commit("saveState"))),o.targetFloor!==o.currentFloor||o.passedFloors.includes(t)||(console.log(`Лифт-${o.id} прибыл на целевой ${o.targetFloor} этаж `),o.passedFloors=[],o.targetFloor=null,o.isMoving=!1,clearInterval(l),this.commit("saveState"),setTimeout((()=>{o.isJustArrived=!0}),50),setTimeout((()=>{if(o.isJustArrived=!1,e.callQueue.length>0){const t=e.callQueue.shift();console.log(`Лифт-${o.id} отправляется на следующий этаж: ${t}`),o.targetFloor=t,this.commit("assignElevatorToFloor",{elevator:o,floor:t}),this.commit("saveState")}}),3e3))}),1e3)},addCallToQueue(e,o){e.callQueue.push(o)},saveState(e){localStorage.setItem("appState",JSON.stringify(e))},replaceState(e,o){Object.keys(e).forEach((t=>{e[t]=o[t]})),e.elevators.forEach((o=>{if(o.isMoving)this.commit("assignElevatorToFloor",{elevator:o,floor:o.targetFloor});else if(e.callQueue.length>0){const t=e.callQueue.shift();console.log(`Лифт-${o.id} отправляется на следующий этаж: ${t}`),o.targetFloor=t,this.commit("assignElevatorToFloor",{elevator:o,floor:t}),this.commit("saveState")}o.isJustArrived&&setTimeout((()=>{o.isJustArrived=!1,this.commit("saveState")}),3e3)}))}},getters:{getTargetFloors:e=>e.elevators.filter((e=>null!==e.targetFloor)).map((e=>e.targetFloor))},actions:{createElevators({commit:e,state:o}){const t=S.numberOfElevators;for(let r=1;r<=t;r++){const o={id:r,currentFloor:1,passedFloors:[],isMoving:!1,isJustArrived:!1,targetFloor:null};e("addElevator",o)}},loadSavedState({commit:e}){const o=JSON.parse(localStorage.getItem("appState"));e("replaceState",o)},callElevator({state:e,commit:o},t){const r=e.elevators.find((e=>e.currentFloor===t)),l=e.elevators.filter((e=>!e.isMoving)),a=e.elevators.find((e=>e.targetFloor===t));if(!r||r.isMoving)if(a)console.log(`К ${t} этажу уже движется лифт`);else if(l.length>0)if(0===e.callQueue.length){const e=l.reduce(((e,o)=>{const r=Math.abs(o.currentFloor-t);return r<e.distance?{elevator:o,distance:r}:e}),{elevator:null,distance:1/0}).elevator;e&&(o("assignElevatorToFloor",{elevator:e,floor:t}),this.commit("saveState"),console.log(`Лифт-${e.id} отправился на ${t} этаж `))}else e.callQueue.includes(t)||(console.log(`Вызов на ${t} этаж  помещён в очередь вызовов`),o("addCallToQueue",t));else e.callQueue.includes(t)||a||(console.log(`Вызов на ${t} этаж  помещён в очередь вызовов`),o("addCallToQueue",t));else console.log(`На ${t} этаже уже есть лифт`)}}});r.ZP.config.productionTip=!1,new r.ZP({store:J,render:e=>e(M)}).$mount("#app")}},o={};function t(r){var l=o[r];if(void 0!==l)return l.exports;var a=o[r]={exports:{}};return e[r].call(a.exports,a,a.exports,t),a.exports}t.m=e,function(){var e=[];t.O=function(o,r,l,a){if(!r){var s=1/0;for(c=0;c<e.length;c++){r=e[c][0],l=e[c][1],a=e[c][2];for(var n=!0,i=0;i<r.length;i++)(!1&a||s>=a)&&Object.keys(t.O).every((function(e){return t.O[e](r[i])}))?r.splice(i--,1):(n=!1,a<s&&(s=a));if(n){e.splice(c--,1);var u=l();void 0!==u&&(o=u)}}return o}a=a||0;for(var c=e.length;c>0&&e[c-1][2]>a;c--)e[c]=e[c-1];e[c]=[r,l,a]}}(),function(){t.n=function(e){var o=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(o,{a:o}),o}}(),function(){t.d=function(e,o){for(var r in o)t.o(o,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:o[r]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){var e={143:0};t.O.j=function(o){return 0===e[o]};var o=function(o,r){var l,a,s=r[0],n=r[1],i=r[2],u=0;if(s.some((function(o){return 0!==e[o]}))){for(l in n)t.o(n,l)&&(t.m[l]=n[l]);if(i)var c=i(t)}for(o&&o(r);u<s.length;u++)a=s[u],t.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return t.O(c)},r=self["webpackChunkElevator_simulation"]=self["webpackChunkElevator_simulation"]||[];r.forEach(o.bind(null,0)),r.push=o.bind(null,r.push.bind(r))}();var r=t.O(void 0,[998],(function(){return t(9739)}));r=t.O(r)})();
//# sourceMappingURL=app.e2e5e3b3.js.map